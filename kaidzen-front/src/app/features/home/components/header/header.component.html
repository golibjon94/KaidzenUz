<header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-gray-100 shadow-sm">
  <nav class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
    <a href="/" class="group">
      <div class="flex items-center gap-2">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:shadow-lg group-hover:shadow-blue-500/50">
          <img src="/sarash-logo.png" alt="">
        </div>
        <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent">
          Sarash
        </span>
      </div>
    </a>

    <div class="hidden md:flex items-center gap-1">
      <a routerLink="/diagnostics" class="px-4 py-2 text-gray-600 font-medium rounded-lg hover:text-blue-600 hover:bg-blue-50 transition-all duration-200">
        Diagnostika
      </a>
      <a routerLink="/blog" class="px-4 py-2 text-gray-600 font-medium rounded-lg hover:text-blue-600 hover:bg-blue-50 transition-all duration-200">
        Foydali ma'lumotlar
      </a>
      <a routerLink="/cases" class="px-4 py-2 text-gray-600 font-medium rounded-lg hover:text-blue-600 hover:bg-blue-50 transition-all duration-200">
        Keyslar
      </a>
      <a routerLink="/about" class="px-4 py-2 text-gray-600 font-medium rounded-lg hover:text-blue-600 hover:bg-blue-50 transition-all duration-200">
        Biz haqimizda
      </a>
    </div>

    <div class="flex items-center gap-3">
      @if (authStore.isAuthenticated()) {
        <button mat-button (click)="goToProfile()" class="!rounded-lg">
          <mat-icon>person_outline</mat-icon>
          {{ authStore.user()?.fullName }}
        </button>
        <button mat-icon-button color="warn" (click)="logout()" matTooltip="Chiqish">
          <mat-icon>logout</mat-icon>
        </button>
      } @else {
        <button mat-button (click)="showLoginModal()" class="!rounded-lg">
          Tizimga kirish
        </button>
        <button mat-flat-button color="primary" (click)="goToRegister()" class="!rounded-full !px-6">
          Ro'yxatdan o'tish
        </button>
      }
    </div>
  </nav>
</header>

<!-- Login Modal -->
@if (isLoginModalVisible()) {
  <div class="fixed inset-0 z-[100] flex items-center justify-center">
    <!-- Backdrop -->
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm" (click)="handleLoginCancel()"></div>

    <!-- Modal -->
    <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-sm mx-4 overflow-hidden">

      <!-- Header -->
      <div class="p-6 pb-2 flex items-center justify-between">
        <div>
          <h3 class="text-lg font-bold text-gray-900">Tizimga kirish</h3>
          <p class="text-sm text-gray-400">Davom etish uchun ma'lumotlaringizni kiriting</p>
        </div>
        <button mat-icon-button (click)="handleLoginCancel()">
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <!-- Form -->
      <div class="p-6 pt-4">
        <form [formGroup]="loginForm" (ngSubmit)="handleLogin()" class="flex flex-col">

          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Telefon raqam</mat-label>
            <span matTextPrefix>+998&nbsp;</span>
            <input matInput formControlName="phone"
                   placeholder="90 123 45 67" type="tel" maxlength="9">
            <mat-error>
              @if (loginForm.get('phone')?.errors?.['required']) {
                Telefon raqamni kiriting
              } @else {
                9 ta raqam kiriting
              }
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Parol</mat-label>
            <mat-icon matPrefix>lock_outline</mat-icon>
            <input matInput formControlName="password"
                   [type]="hidePassword ? 'password' : 'text'"
                   placeholder="••••••••">
            <button mat-icon-button matSuffix type="button"
                    (click)="hidePassword = !hidePassword" tabindex="-1">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error>Kamida 6 ta belgi</mat-error>
          </mat-form-field>

          <button mat-flat-button color="primary" type="submit"
                  class="w-full !h-12 !text-base !rounded-xl" [disabled]="isLoading()">
            @if (isLoading()) {
              <mat-spinner diameter="20" class="inline-block mr-2"></mat-spinner>
            } @else {
              <mat-icon>login</mat-icon>
            }
            Kirish
          </button>
        </form>

        <!-- Divider -->
        <div class="flex items-center gap-3 my-5">
          <div class="flex-1 h-px bg-gray-200"></div>
          <span class="text-xs text-gray-400">yoki</span>
          <div class="flex-1 h-px bg-gray-200"></div>
        </div>

        <!-- Register link -->
        <div class="text-center">
          <p class="text-sm text-gray-500 mb-1">Akkauntingiz yo'qmi?</p>
          <button mat-button color="primary" type="button" (click)="goToRegister()">
            Ro'yxatdan o'tish
          </button>
        </div>
      </div>
    </div>
  </div>
}
