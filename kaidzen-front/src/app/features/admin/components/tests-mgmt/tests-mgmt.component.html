<div class="p-6 max-w-7xl mx-auto">

  <div class="flex items-center justify-between mb-6 bg-white p-4 rounded-xl shadow-sm border border-gray-100">
    <div>
      <h1 class="text-2xl font-bold text-gray-800 m-0">Testlar Boshqaruvi</h1>
      <p class="text-gray-500 text-sm">Tizimdagi barcha testlarni boshqarish</p>
    </div>
    <button nz-button nzType="primary" nzSize="large" (click)="addTest()" class="rounded-lg flex items-center gap-2">
      <span nz-icon nzType="plus"></span>
      Yangi test yaratish
    </button>
  </div>

  <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
    <nz-table #basicTable [nzData]="tests()" [nzLoading]="loading()" [nzPageSize]="10">
      <thead>
      <tr>
        <th nzWidth="300px">Test nomi</th>
        <th>Slug</th>
        <th>Savollar</th>
        <th>Holati</th>
        <th nzRight>Amallar</th>
      </tr>
      </thead>
      <tbody>
        @for (data of basicTable.data; track data.id) {
          <tr class="hover:bg-gray-50 transition-colors">
            <td>
              <div class="font-semibold text-gray-800">{{ data.title }}</div>
              <div class="text-xs text-gray-400 truncate max-w-xs">{{ data.description }}</div>
            </td>
            <td><code class="text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded">{{ data.slug }}</code></td>
            <td><nz-tag nzColor="processing">{{ data._count?.questions || 0 }} ta savol</nz-tag></td>
            <td>
              <nz-badge [nzStatus]="data.isActive ? 'success' : 'default'" [nzText]="data.isActive ? 'Faol' : 'Nofaol'"></nz-badge>
            </td>
            <td nzRight>
              <div class="flex gap-2">
                <button
                  nz-button
                  nzType="text"
                  nzShape="circle"
                  (click)="editTest(data.id)"
                  class="text-blue-500 hover:bg-blue-50"
                  nz-tooltip
                  nzTooltipTitle="Tahrirlash"
                  aria-label="Tahrirlash"
                >
                  <span nz-icon nzType="edit"></span>
                </button>

                <button
                  nz-button
                  nzType="text"
                  nzShape="circle"
                  nzDanger
                  nz-popconfirm
                  nzPopconfirmTitle="Haqiqatan ham o'chirmoqchimisiz?"
                  (nzOnConfirm)="deleteTest(data.id)"
                  nz-tooltip
                  nzTooltipTitle="O‘chirish"
                  aria-label="O‘chirish"
                >
                  <span nz-icon nzType="delete"></span>
                </button>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </nz-table>
  </div>
</div>
